# create inner table with speaker and n. of interventions

create_inner_table = f""" 
CREATE TABLE IF NOT EXISTS inner_table (
id SERIAL PRIMARY KEY,
outer_id INT NOT NULL,
speaker VARCHAR(50) NOT NULL,
interventions SMALLINT NOT NULL
FOREIGN KEY (outer_id) REFERENCES outer_table(id)
)
"""
transition(create_inner_table)

# Create the inner table to be connected to the outer table 

# insert data into inner_table
# id from outer_table to connect inner_table

outer_ids = [1, 2] # ids from outer_table
speakers = ['President', 'Alberto']
interventions = [30, 22]

for oid,s,i in zip(outer_ids, speakers, interventions):
    query = 'INSERT INTO inner_table (outer_ids, speaker, interventions) VALUES (%s, %s, %s)'
    params = (oid, s, i)
    
    transition(query, params)


df = fetch_table_data(table_name='inner_table')
df.head()
